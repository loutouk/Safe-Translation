let pile = ref [] ;
let id = ref 0 ;
let generateId -> let x = !id in id := !id + 1 ; x ;
let pushId id -> pile := id::!pile ;
let popId -> pile := pop !pile ;
let checkId id -> if peek !pile = id then raise{} else () ;

let x = ref 0 in let fun f -> let id = generateId{} in pushId{id} ; x := 0 ; f{} ; checkId{id} ; x:=1 ; f{} ; checkId{id} ; !x ; popId{}